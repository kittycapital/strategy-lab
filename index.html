<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strategy Lab ‚Äî Multi-Asset Investment Simulator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="data.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg0:#000;--bg1:#07070d;--bg2:#0d0d16;--bg3:#13131f;--bg4:#1a1a2a;
  --bdr:#1a1a2e;--bdr2:#282845;
  --t1:#e8e8f0;--t2:#9090a8;--t3:#606078;--t4:#404058;
  --g:#00ff88;--gd:#00cc6a;--r:#ff4466;--b:#4488ff;--y:#ffcc00;--p:#aa66ff;--c:#00ccee;--o:#ff8844;
}
body{background:var(--bg0);color:var(--t1);font-family:'Plus Jakarta Sans',system-ui,sans-serif;overflow-x:hidden}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--bg1)}::-webkit-scrollbar-thumb{background:var(--bdr2);border-radius:3px}
a{color:var(--g);text-decoration:none}
.hdr{padding:16px 28px;border-bottom:1px solid var(--bdr);display:flex;align-items:center;justify-content:space-between;background:var(--bg1);flex-wrap:wrap;gap:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo-i{width:32px;height:32px;background:linear-gradient(135deg,var(--g),var(--c));border-radius:7px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:15px;color:#000}
.logo-t{font-weight:700;font-size:17px;background:linear-gradient(90deg,var(--g),var(--c));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.logo-s{font-size:10px;color:var(--t4);margin-top:-2px}
.tabs{display:flex;gap:3px;background:var(--bg2);border-radius:9px;padding:3px;border:1px solid var(--bdr)}
.tab{padding:7px 16px;border-radius:7px;cursor:pointer;font-size:12px;font-weight:500;color:var(--t2);border:none;background:none;white-space:nowrap;transition:.15s}
.tab:hover{color:var(--t1);background:var(--bg3)}
.tab.on{background:var(--g);color:#000;font-weight:700}
.main{padding:20px 28px;max-width:1400px;margin:0 auto}
.sim-layout{display:grid;grid-template-columns:300px 1fr;gap:20px}
.sidebar{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:16px;height:fit-content;position:sticky;top:16px}
.stitle{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--t4);margin:14px 0 8px}.stitle:first-child{margin-top:0}
.agrid{display:grid;grid-template-columns:1fr 1fr;gap:5px}
.achip{padding:5px 6px;border:1px solid var(--bdr);border-radius:5px;cursor:pointer;font-size:10px;font-weight:500;font-family:'JetBrains Mono',monospace;text-align:center;background:var(--bg1);color:var(--t3);transition:.12s}
.achip:hover{border-color:var(--bdr2);color:var(--t1)}
.achip.on{border-color:var(--g);background:rgba(0,255,136,.07);color:var(--g)}
.achip.dis{opacity:.25;cursor:not-allowed}
.catlbl{grid-column:1/-1;font-size:9px;color:var(--t4);padding:3px 0 1px;font-weight:700;letter-spacing:.5px}
.sbtn{padding:8px 10px;border:1px solid var(--bdr);border-radius:7px;cursor:pointer;font-size:11px;background:var(--bg1);color:var(--t2);transition:.12s;text-align:left;display:flex;flex-direction:column;margin-bottom:5px}
.sbtn:hover{border-color:var(--bdr2);color:var(--t1)}
.sbtn.on{border-color:var(--g);background:rgba(0,255,136,.05);color:var(--t1)}
.sbtn .lb{font-weight:700;font-size:12px}.sbtn .ds{font-size:9px;color:var(--t4);margin-top:1px}
.sgrp{margin-bottom:12px}
.shdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:5px}
.slbl{font-size:11px;color:var(--t2)}
.sval{font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;color:var(--g)}
input[type=range]{width:100%;-webkit-appearance:none;height:3px;background:var(--bdr);border-radius:2px;outline:none}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;background:var(--g);border-radius:50%;cursor:pointer;box-shadow:0 0 6px rgba(0,255,136,.3)}
select{width:100%;padding:7px 9px;background:var(--bg1);border:1px solid var(--bdr);border-radius:5px;color:var(--t1);font-size:11px;font-family:inherit;cursor:pointer}
select:focus{outline:none;border-color:var(--g)}
.prow{display:flex;gap:5px;flex-wrap:wrap}
.pbtn{padding:5px 11px;border:1px solid var(--bdr);border-radius:5px;cursor:pointer;font-size:10px;font-family:'JetBrains Mono',monospace;font-weight:500;background:var(--bg1);color:var(--t3);transition:.12s}
.pbtn:hover{border-color:var(--bdr2)}.pbtn.on{border-color:var(--g);background:rgba(0,255,136,.07);color:var(--g)}
.runbtn{width:100%;padding:11px;background:var(--g);border:none;border-radius:7px;font-size:13px;font-weight:700;color:#000;cursor:pointer;margin-top:16px;font-family:inherit;transition:.2s}
.runbtn:hover{background:#00ff99;box-shadow:0 0 18px rgba(0,255,136,.3)}
.rpanel{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:20px;min-height:400px}
.empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:400px;color:var(--t4);gap:10px}
.empty .ic{font-size:42px;opacity:.3}.empty .mg{font-size:13px}
.loading{display:flex;align-items:center;justify-content:center;height:300px;flex-direction:column;gap:10px}
.spinner{width:36px;height:36px;border:3px solid var(--bdr);border-top-color:var(--g);border-radius:50%;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.sgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:10px;margin-bottom:16px}
.scard{background:var(--bg1);border:1px solid var(--bdr);border-radius:7px;padding:12px}
.scard .sl{font-size:10px;color:var(--t4);margin-bottom:3px;text-transform:uppercase;letter-spacing:.5px}
.scard .sv{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:700}
.scard .sv.pos{color:var(--g)}.scard .sv.neg{color:var(--r)}
.scard .ss{font-size:9px;color:var(--t4);margin-top:2px;font-family:'JetBrains Mono',monospace}
table.ct{width:100%;border-collapse:collapse;font-size:11px}
.ct th{text-align:left;padding:8px 10px;border-bottom:1px solid var(--bdr2);font-size:9px;text-transform:uppercase;letter-spacing:1px;color:var(--t4);font-weight:700}
.ct td{padding:8px 10px;border-bottom:1px solid var(--bdr);font-family:'JetBrains Mono',monospace;font-size:11px}
.ct tr:hover td{background:var(--bg3)}
.chart-wrap{width:100%;margin-bottom:20px;position:relative}
.tm-hero{text-align:center;padding:32px 16px 24px}
.tm-hero h2{font-size:28px;font-weight:800;background:linear-gradient(135deg,var(--g),var(--c),var(--p));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:6px}
.tm-hero p{color:var(--t2);font-size:13px;max-width:460px;margin:0 auto}
.tm-ctrls{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin:20px 0}
.tm-ctrl{background:var(--bg2);border:1px solid var(--bdr);border-radius:9px;padding:14px 16px;min-width:180px}
.tm-ctrl label{font-size:10px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;display:block;margin-bottom:6px;font-weight:700}
.tm-ctrl select,.tm-ctrl input{width:100%;padding:9px 10px;background:var(--bg1);border:1px solid var(--bdr);border-radius:5px;color:var(--t1);font-size:13px;font-family:'JetBrains Mono',monospace;font-weight:600}
.tm-ctrl input:focus{outline:none;border-color:var(--g)}
.tm-run{padding:12px 40px;background:linear-gradient(135deg,var(--g),var(--c));border:none;border-radius:9px;font-size:14px;font-weight:700;color:#000;cursor:pointer;margin:16px auto;display:block;font-family:inherit;transition:.3s}
.tm-run:hover{transform:scale(1.04);box-shadow:0 0 24px rgba(0,255,136,.3)}
.podium{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:20px;max-width:860px;margin-left:auto;margin-right:auto}
.pod{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:18px;text-align:center;position:relative;overflow:hidden}
.pod.g{border-color:var(--y)}.pod.g::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,transparent,var(--y),transparent)}
.pod.s{border-color:var(--t4)}.pod.b{border-color:var(--o)}
.pod .rk{font-size:26px;font-weight:800;margin-bottom:3px}
.pod .pa{font-size:13px;font-weight:700;margin-bottom:2px}.pod .ps{font-size:10px;color:var(--t4);margin-bottom:7px}
.pod .pv{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700;color:var(--g)}
.pod .pr{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--t2);margin-top:3px}
.pfgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px}
.pfcard{background:var(--bg2);border:1px solid var(--bdr);border-radius:11px;padding:20px}
.pfcard h3{font-size:15px;font-weight:700;margin-bottom:3px}.pfcard .dd{font-size:11px;color:var(--t2);margin-bottom:14px}
.abar{display:flex;height:22px;border-radius:3px;overflow:hidden;margin-bottom:10px}
.abar>div{transition:width .3s}
.alist{font-size:10px}
.aitm{display:flex;justify-content:space-between;align-items:center;padding:3px 0;border-bottom:1px solid var(--bdr)}
.aitm .dot{width:7px;height:7px;border-radius:50%;margin-right:6px;display:inline-block}
@media(max-width:900px){.sim-layout{grid-template-columns:1fr}.sidebar{position:static}.podium{grid-template-columns:1fr}.hdr{padding:12px 16px}.main{padding:12px 16px}}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useMemo,useCallback,useEffect,useRef,memo}=React;

/* ===== VERIFY DATA ===== */
if(typeof ASSET_DATA==='undefined'){
  document.getElementById('root').innerHTML='<div style="color:#ff4466;padding:40px;text-align:center;font-family:monospace"><h2>Error: data.js not found</h2><p>Make sure data.js is in the same folder as index.html</p></div>';
  throw new Error('ASSET_DATA not defined');
}

/* ===== CONSTANTS ===== */
const ASSETS=['SPY','QQQ','DIA','IWM','BTC_USD','ETH_USD','GLD','SLV','USO','TLT','EEM','EWY','XLE','SCHD','ARKK'];
const COLORS={SPY:'#00ff88',QQQ:'#4488ff',DIA:'#ffcc00',IWM:'#ff8844',BTC_USD:'#f7931a',ETH_USD:'#627eea',GLD:'#ffd700',SLV:'#c0c0c0',USO:'#8b6914',TLT:'#00ccee',EEM:'#aa66ff',EWY:'#ff4466',XLE:'#44cc44',SCHD:'#ff66aa',ARKK:'#cc44ff'};
const EVENTS=[{d:'2001-09-11',l:'9/11'},{d:'2008-09-15',l:'2008 Crisis'},{d:'2020-03-11',l:'COVID'},{d:'2022-01-03',l:'2022 Bear'}];
const LIFE_EVENTS=[{l:'Graduated College (2000)',y:2000},{l:'Graduated College (2005)',y:2005},{l:'Before 2008 Crash',y:2007},{l:'After 2008 Crash',y:2009},{l:'Started Career (2010)',y:2010},{l:'Started Investing (2015)',y:2015},{l:'Before COVID (2019)',y:2019},{l:'COVID Lockdown (2020)',y:2020},{l:'Crypto Bull (2021)',y:2021},{l:'2022 Bear Bottom',y:2022}];

/* ===== ENGINE ===== */
function calcSMA(p,n){const s=new Array(p.length).fill(null);for(let i=n-1;i<p.length;i++){let sum=0;for(let j=i-n+1;j<=i;j++)sum+=p[j];s[i]=sum/n;}return s;}
function calcRSI(p,n){const r=new Array(p.length).fill(null);if(p.length<n+1)return r;let g=0,l=0;for(let i=1;i<=n;i++){const c=p[i]-p[i-1];if(c>0)g+=c;else l-=c;}let ag=g/n,al=l/n;r[n]=al===0?100:100-100/(1+ag/al);for(let i=n+1;i<p.length;i++){const c=p[i]-p[i-1];ag=(ag*(n-1)+Math.max(c,0))/n;al=(al*(n-1)+Math.max(-c,0))/n;r[i]=al===0?100:100-100/(1+ag/al);}return r;}
function calcDD(p){const d=new Array(p.length).fill(0);let pk=p[0];for(let i=1;i<p.length;i++){if(p[i]>pk)pk=p[i];d[i]=(p[i]-pk)/pk;}return d;}
function findIdx(dates,t){for(let i=0;i<dates.length;i++){if(dates[i]>=t)return i;}return dates.length-1;}
function getStart(yrs){const d=new Date();d.setFullYear(d.getFullYear()-yrs);return d.toISOString().split('T')[0];}

function runStrategy(ticker,sType,params,startDate,endDate){
  const raw=ASSET_DATA[ticker];
  if(!raw)return null;
  const dates=raw.dates, prices=raw.prices, label=raw.label;
  var si=findIdx(dates,startDate), ei=endDate?findIdx(dates,endDate):dates.length-1;
  if(si>=ei)return null;
  const budget=params.budget||500, frequency=params.frequency||'monthly', maPeriod=params.maPeriod||200, maThreshold=params.maThreshold||0, dipThreshold=params.dipThreshold||-10, rsiThreshold=params.rsiThreshold||30;
  const sma=calcSMA(prices,maPeriod), rsi=calcRSI(prices,14), dd=calcDD(prices);
  var shares=0, invested=0, lastM=-1, lastW=-1;
  const curve=[];
  const bhStart=prices[si];

  for(var i=si;i<=ei;i++){
    var date=dates[i], price=prices[i], dt=new Date(date);
    var mo=dt.getFullYear()*12+dt.getMonth(), wk=Math.floor(dt.getTime()/(7*864e5));
    var buy=false, amt=budget;

    if(sType==='dca'){
      if(frequency==='daily'){buy=true;amt=budget/21;}
      else if(frequency==='weekly'){if(wk!==lastW){buy=true;amt=budget/4.33;lastW=wk;}}
      else{if(mo!==lastM){buy=true;lastM=mo;}}
    }else if(sType==='ma'){
      if(mo!==lastM&&sma[i]!==null){lastM=mo;var pct=(price-sma[i])/sma[i]*100;if(pct<=maThreshold){buy=true;amt=budget*Math.min(3,1+Math.abs(pct-maThreshold)/10);}}
    }else if(sType==='dip'){
      if(mo!==lastM){lastM=mo;var dp=dd[i]*100,rs=rsi[i];if(dp<=dipThreshold||(rs!==null&&rs<=rsiThreshold)){buy=true;amt=budget*Math.min(3,1+Math.abs(dp)/15);}else{buy=true;amt=budget*0.3;}}
    }else if(sType==='hybrid'){
      if(mo!==lastM){lastM=mo;buy=true;amt=budget*0.5;if(sma[i]!==null&&price<sma[i])amt+=budget*0.25;if(dd[i]*100<=dipThreshold)amt+=budget*0.5;if(rsi[i]!==null&&rsi[i]<=rsiThreshold)amt+=budget*0.25;}
    }

    if(buy&&amt>0){shares+=amt/price;invested+=amt;}
    var val=shares*price;
    var bh=invested>0?(invested/bhStart)*price:0;
    curve.push({date:date,value:Math.round(val*100)/100,invested:Math.round(invested*100)/100,buyHold:Math.round(bh*100)/100});
  }

  if(curve.length===0||invested===0)return null;
  var fv=curve[curve.length-1].value;
  var yrs=(new Date(dates[ei])-new Date(dates[si]))/(365.25*864e5);
  var tr=((fv-invested)/invested)*100;
  var cagr=yrs>0?(Math.pow(fv/invested,1/yrs)-1)*100:0;
  var pk2=0,mdd=0;
  for(var j=0;j<curve.length;j++){if(curve[j].value>pk2)pk2=curve[j].value;var d2=pk2>0?(curve[j].value-pk2)/pk2:0;if(d2<mdd)mdd=d2;}
  var bhF=curve[curve.length-1].buyHold;
  var bhR=invested>0?((bhF-invested)/invested)*100:0;

  return{ticker:ticker,label:label,curve:curve,invested:invested,finalValue:fv,totalReturn:tr,cagr:cagr,maxDD:mdd*100,avgCost:shares>0?invested/shares:0,shares:shares,bhFinal:bhF,bhReturn:bhR,years:yrs,numBuys:curve.filter(function(_,idx,a){return idx===0||a[idx].invested!==a[idx-1].invested;}).length,sType:sType,params:params};
}

/* ===== FORMAT ===== */
function fmt(n){if(Math.abs(n)>=1e6)return'$'+(n/1e6).toFixed(2)+'M';if(Math.abs(n)>=1e3)return'$'+(n/1e3).toFixed(1)+'K';return'$'+n.toFixed(2);}
function fPct(n){return(n>=0?'+':'')+n.toFixed(2)+'%';}
function fNum(n){return n.toLocaleString(undefined,{maximumFractionDigits:2});}

/* ===== CANVAS CHART ===== */
function CanvasChart(props){
  var results=props.results, height=props.height||380, showBH=props.showBH!==false;
  var canvasRef=useRef(null);
  var wrapRef=useRef(null);
  var tipRef=useRef(null);
  var [tip,setTip]=useState(null);

  var chartData=useMemo(function(){
    if(!results||!results.length)return null;
    // Use longest curve as base
    var longest=results[0];
    for(var i=1;i<results.length;i++){if(results[i].curve.length>longest.curve.length)longest=results[i];}
    // Sample down if >600 points
    var raw=longest.curve;
    var step=Math.max(1,Math.floor(raw.length/600));
    var sampled=[];
    for(var i=0;i<raw.length;i++){if(i%step===0||i===raw.length-1)sampled.push(i);}
    // Build data
    var data=sampled.map(function(idx){
      var pt={date:longest.curve[idx].date};
      results.forEach(function(r){if(r.curve[idx]){pt[r.ticker]=r.curve[idx].value;pt[r.ticker+'_bh']=r.curve[idx].buyHold;}});
      return pt;
    });
    return data;
  },[results]);

  useEffect(function(){
    if(!canvasRef.current||!wrapRef.current||!chartData||!chartData.length)return;
    var canvas=canvasRef.current;
    var wrap=wrapRef.current;
    var w=wrap.clientWidth;
    var h=height;
    var dpr=window.devicePixelRatio||1;
    canvas.width=w*dpr;
    canvas.height=h*dpr;
    canvas.style.width=w+'px';
    canvas.style.height=h+'px';
    var ctx=canvas.getContext('2d');
    ctx.scale(dpr,dpr);

    var pad={t:24,r:16,b:32,l:66};
    var cw=w-pad.l-pad.r, ch=h-pad.t-pad.b;
    if(cw<40||ch<40)return;

    // Y range
    var yMin=Infinity,yMax=-Infinity;
    chartData.forEach(function(pt){
      results.forEach(function(r){
        if(pt[r.ticker]!==undefined){yMin=Math.min(yMin,pt[r.ticker]);yMax=Math.max(yMax,pt[r.ticker]);}
        if(showBH&&pt[r.ticker+'_bh']!==undefined){yMin=Math.min(yMin,pt[r.ticker+'_bh']);yMax=Math.max(yMax,pt[r.ticker+'_bh']);}
      });
    });
    if(yMin===yMax){yMin*=0.9;yMax*=1.1;}
    var yPad2=(yMax-yMin)*0.08;yMin=Math.max(0,yMin-yPad2);yMax+=yPad2;

    var xPos=function(i){return pad.l+(i/(chartData.length-1))*cw;};
    var yPos=function(v){return pad.t+ch-(v-yMin)/(yMax-yMin)*ch;};

    // Clear
    ctx.clearRect(0,0,w,h);

    // Grid
    ctx.strokeStyle='#1a1a2e';ctx.lineWidth=1;
    ctx.fillStyle='#505068';ctx.font='9px JetBrains Mono,monospace';ctx.textAlign='right';
    var yStep2=Math.pow(10,Math.floor(Math.log10((yMax-yMin)/4)));
    if((yMax-yMin)/yStep2>8)yStep2*=2;
    for(var yt=Math.ceil(yMin/yStep2)*yStep2;yt<=yMax;yt+=yStep2){
      var yy=yPos(yt);
      ctx.beginPath();ctx.moveTo(pad.l,yy);ctx.lineTo(w-pad.r,yy);ctx.stroke();
      ctx.fillText(fmt(yt),pad.l-6,yy+3);
    }

    // X labels
    ctx.textAlign='center';
    var labelStep=Math.max(1,Math.floor(chartData.length/7));
    for(var i=0;i<chartData.length;i+=labelStep){
      var d=chartData[i].date;
      ctx.fillText(d.slice(5,7)+'/'+d.slice(2,4),xPos(i),h-8);
    }

    // Event lines
    ctx.strokeStyle='#ff446630';ctx.setLineDash([3,3]);ctx.lineWidth=1;
    ctx.fillStyle='#ff446660';ctx.font='8px Plus Jakarta Sans,sans-serif';ctx.textAlign='center';
    EVENTS.forEach(function(e){
      for(var i=0;i<chartData.length;i++){
        if(chartData[i].date>=e.d){
          var ex=xPos(i);
          ctx.beginPath();ctx.moveTo(ex,pad.t);ctx.lineTo(ex,pad.t+ch);ctx.stroke();
          ctx.fillText(e.l,ex,pad.t-6);
          break;
        }
      }
    });
    ctx.setLineDash([]);

    // Buy & Hold dashed lines
    if(showBH){
      ctx.setLineDash([4,4]);ctx.lineWidth=1.5;ctx.strokeStyle='#ffffff15';
      results.forEach(function(r){
        ctx.beginPath();
        var started=false;
        for(var i=0;i<chartData.length;i++){
          if(chartData[i][r.ticker+'_bh']!==undefined){
            var xx=xPos(i),yy2=yPos(chartData[i][r.ticker+'_bh']);
            if(!started){ctx.moveTo(xx,yy2);started=true;}else{ctx.lineTo(xx,yy2);}
          }
        }
        ctx.stroke();
      });
      ctx.setLineDash([]);
    }

    // Strategy lines
    results.forEach(function(r){
      ctx.strokeStyle=COLORS[r.ticker];ctx.lineWidth=2.5;ctx.lineJoin='round';ctx.lineCap='round';
      ctx.beginPath();
      var started=false;
      for(var i=0;i<chartData.length;i++){
        if(chartData[i][r.ticker]!==undefined){
          var xx=xPos(i),yy2=yPos(chartData[i][r.ticker]);
          if(!started){ctx.moveTo(xx,yy2);started=true;}else{ctx.lineTo(xx,yy2);}
        }
      }
      ctx.stroke();
    });

    // Store for tooltip
    canvas._chartMeta={pad:pad,cw:cw,ch:ch,data:chartData,results:results,xPos:xPos,yPos:yPos};
  },[chartData,results,height,showBH]);

  var handleMouse=function(e){
    if(!canvasRef.current||!canvasRef.current._chartMeta)return;
    var rect=canvasRef.current.getBoundingClientRect();
    var mx=e.clientX-rect.left;
    var meta=canvasRef.current._chartMeta;
    var relX=mx-meta.pad.l;
    if(relX<0||relX>meta.cw){setTip(null);return;}
    var idx=Math.round((relX/meta.cw)*(meta.data.length-1));
    var pt=meta.data[Math.min(idx,meta.data.length-1)];
    if(!pt){setTip(null);return;}
    var vals=[];
    meta.results.forEach(function(r){
      if(pt[r.ticker]!==undefined){vals.push({ticker:r.ticker,label:r.label,value:pt[r.ticker],bh:pt[r.ticker+'_bh'],color:COLORS[r.ticker]});}
    });
    setTip({x:e.clientX-rect.left,y:e.clientY-rect.top,date:pt.date,vals:vals});
  };

  if(!results||!results.length)return null;

  return React.createElement('div',{ref:wrapRef,className:'chart-wrap',style:{height:height},onMouseMove:handleMouse,onMouseLeave:function(){setTip(null);}},
    React.createElement('canvas',{ref:canvasRef,style:{display:'block'}}),
    // Legend
    React.createElement('div',{style:{position:'absolute',top:4,right:8,display:'flex',gap:12,flexWrap:'wrap'}},
      results.map(function(r){return React.createElement('div',{key:r.ticker,style:{display:'flex',alignItems:'center',gap:4,fontSize:10,color:COLORS[r.ticker]}},React.createElement('div',{style:{width:10,height:3,background:COLORS[r.ticker],borderRadius:2}}),r.label);})
    ),
    // Tooltip
    tip&&React.createElement('div',{style:{position:'absolute',left:Math.min(tip.x+12,(wrapRef.current?wrapRef.current.clientWidth:800)-180),top:Math.max(tip.y-60,8),background:'#0d0d16ee',border:'1px solid #282845',borderRadius:8,padding:'8px 10px',fontSize:10,pointerEvents:'none',zIndex:10,minWidth:140}},
      React.createElement('div',{style:{color:'#9090a8',marginBottom:4,fontFamily:'JetBrains Mono,monospace'}},new Date(tip.date).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'})),
      tip.vals.map(function(v){return React.createElement('div',{key:v.ticker,style:{display:'flex',justifyContent:'space-between',gap:16,marginBottom:2}},React.createElement('span',{style:{color:v.color,fontWeight:600}},v.label),React.createElement('span',{style:{fontFamily:'JetBrains Mono,monospace',color:'#00ff88'}},fmt(v.value)));})
    )
  );
}

/* ===== STAT CARD ===== */
function SC(props){
  return React.createElement('div',{className:'scard'},
    React.createElement('div',{className:'sl'},props.label),
    React.createElement('div',{className:'sv'+(props.pos===true?' pos':props.pos===false?' neg':'')},props.value),
    props.sub&&React.createElement('div',{className:'ss'},props.sub)
  );
}

/* ===== ASSET SELECTOR ===== */
function AssetSel(props){
  var sel=props.sel,onChange=props.onChange,max=props.max||4;
  var toggle=function(t){
    if(sel.indexOf(t)>=0){onChange(sel.filter(function(x){return x!==t;}));}
    else if(sel.length<max){onChange(sel.concat([t]));}
  };
  var elements=[];
  var cats=Object.entries(CATEGORIES);
  cats.forEach(function(entry){
    var cat=entry[0],tickers=entry[1];
    elements.push(React.createElement('div',{key:'cat_'+cat,className:'catlbl'},cat));
    tickers.forEach(function(t){
      var on=sel.indexOf(t)>=0;
      var dis=!on&&sel.length>=max;
      elements.push(React.createElement('div',{key:t,className:'achip'+(on?' on':'')+(dis?' dis':''),onClick:function(){if(!dis)toggle(t);}},t.replace('_','/')));
    });
  });
  return React.createElement('div',{className:'agrid'},elements);
}

/* ===== TAB 1: SIMULATOR ===== */
function Simulator(){
  var s=useState(['SPY']),assets=s[0],setA=s[1];
  var s2=useState('dca'),strat=s2[0],setS=s2[1];
  var s3=useState('monthly'),freq=s3[0],setF=s3[1];
  var s4=useState(500),budget=s4[0],setB=s4[1];
  var s5=useState(200),maP=s5[0],setMP=s5[1];
  var s6=useState(0),maT=s6[0],setMT=s6[1];
  var s7=useState(-10),dipT=s7[0],setDT=s7[1];
  var s8=useState(30),rsiT=s8[0],setRT=s8[1];
  var s9=useState(10),period=s9[0],setP=s9[1];
  var s10=useState(null),res=s10[0],setR=s10[1];
  var s11=useState(false),busy=s11[0],setBusy=s11[1];

  var run=function(){
    setBusy(true);
    setTimeout(function(){
      var sd=getStart(period);
      var r=[];
      assets.forEach(function(t){
        var result=runStrategy(t,strat,{budget:budget,frequency:freq,maPeriod:maP,maThreshold:maT,dipThreshold:dipT,rsiThreshold:rsiT},sd,null);
        if(result)r.push(result);
      });
      setR(r);setBusy(false);
    },30);
  };

  var sNames={dca:'Dollar-Cost Averaging',ma:'Moving Average',dip:'Dip Buying',hybrid:'Hybrid'};
  var stratDefs=[
    {id:'dca',l:'DCA',d:'Buy on fixed schedule'},
    {id:'ma',l:'Moving Average',d:'Buy below the MA line'},
    {id:'dip',l:'Dip Buying',d:'Buy on drawdowns & low RSI'},
    {id:'hybrid',l:'Hybrid',d:'DCA + extra on dips & below MA'}
  ];

  return React.createElement('div',{className:'sim-layout'},
    // Sidebar
    React.createElement('div',{className:'sidebar'},
      React.createElement('div',{className:'stitle'},'Select Assets (max 4)'),
      React.createElement(AssetSel,{sel:assets,onChange:setA,max:4}),
      React.createElement('div',{className:'stitle'},'Strategy'),
      stratDefs.map(function(s){return React.createElement('div',{key:s.id,className:'sbtn'+(strat===s.id?' on':''),onClick:function(){setS(s.id);}},React.createElement('span',{className:'lb'},s.l),React.createElement('span',{className:'ds'},s.d));}),
      React.createElement('div',{className:'stitle'},'Parameters'),
      // Budget
      React.createElement('div',{className:'sgrp'},
        React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'Monthly Budget'),React.createElement('span',{className:'sval'},'$'+budget)),
        React.createElement('input',{type:'range',min:100,max:5000,step:100,value:budget,onChange:function(e){setB(+e.target.value);}})
      ),
      // DCA frequency
      strat==='dca'&&React.createElement('div',{className:'sgrp'},
        React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'Frequency')),
        React.createElement('select',{value:freq,onChange:function(e){setF(e.target.value);}},
          React.createElement('option',{value:'daily'},'Daily'),
          React.createElement('option',{value:'weekly'},'Weekly'),
          React.createElement('option',{value:'monthly'},'Monthly')
        )
      ),
      // MA params
      (strat==='ma'||strat==='hybrid')&&React.createElement(React.Fragment,null,
        React.createElement('div',{className:'sgrp'},
          React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'MA Period'),React.createElement('span',{className:'sval'},maP+'d')),
          React.createElement('input',{type:'range',min:10,max:300,step:10,value:maP,onChange:function(e){setMP(+e.target.value);}})
        ),
        strat==='ma'&&React.createElement('div',{className:'sgrp'},
          React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'Buy below MA by'),React.createElement('span',{className:'sval'},maT+'%')),
          React.createElement('input',{type:'range',min:-20,max:5,step:1,value:maT,onChange:function(e){setMT(+e.target.value);}})
        )
      ),
      // Dip params
      (strat==='dip'||strat==='hybrid')&&React.createElement(React.Fragment,null,
        React.createElement('div',{className:'sgrp'},
          React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'Drawdown Threshold'),React.createElement('span',{className:'sval'},dipT+'%')),
          React.createElement('input',{type:'range',min:-40,max:-3,step:1,value:dipT,onChange:function(e){setDT(+e.target.value);}})
        ),
        React.createElement('div',{className:'sgrp'},
          React.createElement('div',{className:'shdr'},React.createElement('span',{className:'slbl'},'RSI Threshold'),React.createElement('span',{className:'sval'},rsiT)),
          React.createElement('input',{type:'range',min:15,max:50,step:1,value:rsiT,onChange:function(e){setRT(+e.target.value);}})
        )
      ),
      React.createElement('div',{className:'stitle'},'Time Period'),
      React.createElement('div',{className:'prow'},[25,20,15,10,5,3].map(function(y){return React.createElement('div',{key:y,className:'pbtn'+(period===y?' on':''),onClick:function(){setP(y);}},y+'Y');})),
      React.createElement('button',{className:'runbtn',onClick:run},'‚ñ∂ Run Simulation')
    ),
    // Results
    React.createElement('div',{className:'rpanel'},
      busy?React.createElement('div',{className:'loading'},React.createElement('div',{className:'spinner'}),React.createElement('span',{style:{color:'var(--t4)',fontSize:12}},'Computing...')):
      !res?React.createElement('div',{className:'empty'},React.createElement('div',{className:'ic'},'üìä'),React.createElement('span',{className:'mg'},'Select assets, configure strategy, and hit Run')):
      React.createElement(React.Fragment,null,
        React.createElement('div',{style:{fontSize:15,fontWeight:600,marginBottom:16}},sNames[strat]+' ‚Äî '+period+' Year Backtest'),
        React.createElement(CanvasChart,{results:res,showBH:true}),
        res.map(function(r){
          return React.createElement('div',{key:r.ticker,style:{marginBottom:20}},
            React.createElement('div',{style:{display:'flex',alignItems:'center',gap:7,marginBottom:10}},
              React.createElement('div',{style:{width:10,height:10,borderRadius:3,background:COLORS[r.ticker]}}),
              React.createElement('span',{style:{fontWeight:700,fontSize:14}},r.label),
              React.createElement('span',{style:{color:'var(--t4)',fontSize:11,fontFamily:'JetBrains Mono'}},r.ticker.replace('_','/'))
            ),
            React.createElement('div',{className:'sgrid'},
              React.createElement(SC,{label:'Final Value',value:fmt(r.finalValue),sub:'Invested: '+fmt(r.invested),pos:r.finalValue>r.invested}),
              React.createElement(SC,{label:'Total Return',value:fPct(r.totalReturn),sub:'Buy&Hold: '+fPct(r.bhReturn),pos:r.totalReturn>0}),
              React.createElement(SC,{label:'CAGR',value:fPct(r.cagr),pos:r.cagr>0}),
              React.createElement(SC,{label:'Max Drawdown',value:fPct(r.maxDD),pos:false}),
              React.createElement(SC,{label:'Avg Cost Basis',value:'$'+fNum(r.avgCost),sub:fNum(r.shares)+' shares'}),
              React.createElement(SC,{label:'Time Period',value:r.years.toFixed(1)+'yr'})
            )
          );
        }),
        res.length>1&&React.createElement(React.Fragment,null,
          React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'Comparison'),
          React.createElement('table',{className:'ct'},
            React.createElement('thead',null,React.createElement('tr',null,
              React.createElement('th',null,'Asset'),React.createElement('th',null,'Final Value'),React.createElement('th',null,'Return'),React.createElement('th',null,'CAGR'),React.createElement('th',null,'Max DD'),React.createElement('th',null,'vs Buy&Hold')
            )),
            React.createElement('tbody',null,
              res.slice().sort(function(a,b){return b.finalValue-a.finalValue;}).map(function(r){
                return React.createElement('tr',{key:r.ticker},
                  React.createElement('td',{style:{color:COLORS[r.ticker],fontWeight:600}},r.label),
                  React.createElement('td',{style:{color:'var(--g)'}},fmt(r.finalValue)),
                  React.createElement('td',{style:{color:r.totalReturn>0?'var(--g)':'var(--r)'}},fPct(r.totalReturn)),
                  React.createElement('td',null,fPct(r.cagr)),
                  React.createElement('td',{style:{color:'var(--r)'}},fPct(r.maxDD)),
                  React.createElement('td',{style:{color:r.totalReturn>r.bhReturn?'var(--g)':'var(--r)'}},(r.totalReturn>r.bhReturn?'‚ñ≤ ':'‚ñº ')+Math.abs(r.totalReturn-r.bhReturn).toFixed(1)+'%')
                );
              })
            )
          )
        )
      )
    )
  );
}

/* ===== TAB 2: TIME MACHINE ===== */
function TimeMachine(){
  var s1=useState(0),evt=s1[0],setE=s1[1];
  var s2=useState(''),cYear=s2[0],setCY=s2[1];
  var s3=useState(500),budget=s3[0],setB=s3[1];
  var s4=useState(null),res=s4[0],setR=s4[1];
  var s5=useState(false),busy=s5[0],setBusy=s5[1];

  var run=function(){
    setBusy(true);
    setTimeout(function(){
      var yr=cYear?parseInt(cYear):LIFE_EVENTS[evt].y;
      var sd=yr+'-01-01';
      var strats=[
        {t:'dca',l:'Monthly DCA',p:{budget:budget,frequency:'monthly'}},
        {t:'dca',l:'Weekly DCA',p:{budget:budget,frequency:'weekly'}},
        {t:'ma',l:'MA200 Strategy',p:{budget:budget,maPeriod:200,maThreshold:0}},
        {t:'ma',l:'MA50 Aggressive',p:{budget:budget,maPeriod:50,maThreshold:-5}},
        {t:'dip',l:'Dip Buy -10%',p:{budget:budget,dipThreshold:-10,rsiThreshold:30}},
        {t:'dip',l:'Dip Buy -20%',p:{budget:budget,dipThreshold:-20,rsiThreshold:25}},
        {t:'hybrid',l:'Hybrid',p:{budget:budget,maPeriod:200,dipThreshold:-10,rsiThreshold:30}}
      ];
      var all=[];
      ASSETS.forEach(function(tk){strats.forEach(function(s){var r=runStrategy(tk,s.t,s.p,sd,null);if(r){r.stratLabel=s.l;all.push(r);}});});
      all.sort(function(a,b){return b.finalValue-a.finalValue;});
      setR({all:all,yr:yr,budget:budget});setBusy(false);
    },80);
  };

  return React.createElement('div',null,
    React.createElement('div',{className:'tm-hero'},
      React.createElement('h2',null,'‚è∞ Time Machine'),
      React.createElement('p',null,'Pick a moment in your past. See what every strategy would be worth today.')
    ),
    React.createElement('div',{className:'tm-ctrls'},
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'Life Event'),
        React.createElement('select',{value:evt,onChange:function(e){setE(+e.target.value);setCY('');}},LIFE_EVENTS.map(function(e,i){return React.createElement('option',{key:i,value:i},e.l);}))
      ),
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'Or Custom Year'),
        React.createElement('input',{type:'number',min:1998,max:2025,placeholder:'e.g. 2015',value:cYear,onChange:function(e){setCY(e.target.value);}})
      ),
      React.createElement('div',{className:'tm-ctrl'},
        React.createElement('label',null,'Monthly Budget'),
        React.createElement('select',{value:budget,onChange:function(e){setB(+e.target.value);}},[100,200,300,500,1000,2000,5000].map(function(b){return React.createElement('option',{key:b,value:b},'$'+b+'/mo');}))
      )
    ),
    React.createElement('button',{className:'tm-run',onClick:run},'üöÄ Calculate All Strategies'),
    busy&&React.createElement('div',{className:'loading'},React.createElement('div',{className:'spinner'}),React.createElement('span',{style:{color:'var(--t4)',fontSize:12}},'Testing '+ASSETS.length*7+' combos...')),
    res&&!busy&&React.createElement('div',{style:{marginTop:20}},
      React.createElement('div',{style:{textAlign:'center',color:'var(--t2)',fontSize:12,marginBottom:16}},
        'From ',React.createElement('span',{style:{color:'var(--g)',fontWeight:700}},res.yr),' with ',React.createElement('span',{style:{color:'var(--g)',fontWeight:700}},'$'+res.budget+'/mo'),' ‚Äî '+res.all.length+' combinations tested'
      ),
      // Podium
      React.createElement('div',{className:'podium'},
        res.all.slice(0,3).map(function(r,i){
          var cls=['g','s','b'][i];
          return React.createElement('div',{key:i,className:'pod '+cls},
            React.createElement('div',{className:'rk'},['ü•á','ü•à','ü•â'][i]),
            React.createElement('div',{className:'pa'},r.label),
            React.createElement('div',{className:'ps'},r.stratLabel),
            React.createElement('div',{className:'pv'},fmt(r.finalValue)),
            React.createElement('div',{className:'pr'},fPct(r.totalReturn)+' ¬∑ Invested '+fmt(r.invested))
          );
        })
      ),
      // Top 3 chart
      React.createElement('div',{style:{background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16,marginBottom:16}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'Top 3 Equity Curves'),
        React.createElement(CanvasChart,{results:res.all.slice(0,3),showBH:false})
      ),
      // Full table
      React.createElement('div',{style:{background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16,maxHeight:480,overflowY:'auto'}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'All Results (Top 50)'),
        React.createElement('table',{className:'ct'},
          React.createElement('thead',null,React.createElement('tr',null,
            React.createElement('th',null,'#'),React.createElement('th',null,'Asset'),React.createElement('th',null,'Strategy'),React.createElement('th',null,'Final Value'),React.createElement('th',null,'Invested'),React.createElement('th',null,'Return'),React.createElement('th',null,'CAGR'),React.createElement('th',null,'Max DD')
          )),
          React.createElement('tbody',null,
            res.all.slice(0,50).map(function(r,i){
              return React.createElement('tr',{key:i},
                React.createElement('td',{style:{color:i<3?'var(--y)':'var(--t4)'}},i+1),
                React.createElement('td',{style:{color:COLORS[r.ticker],fontWeight:600}},r.label),
                React.createElement('td',null,r.stratLabel),
                React.createElement('td',{style:{color:'var(--g)',fontWeight:600}},fmt(r.finalValue)),
                React.createElement('td',{style:{color:'var(--t2)'}},fmt(r.invested)),
                React.createElement('td',{style:{color:r.totalReturn>0?'var(--g)':'var(--r)'}},fPct(r.totalReturn)),
                React.createElement('td',null,fPct(r.cagr)),
                React.createElement('td',{style:{color:'var(--r)'}},fPct(r.maxDD))
              );
            })
          )
        )
      )
    )
  );
}

/* ===== TAB 3: BEST PORTFOLIOS ===== */
function BestPortfolios(){
  var s1=useState(10),period=s1[0],setP=s1[1];
  var s2=useState(null),res=s2[0],setR=s2[1];
  var s3=useState(false),busy=s3[0],setBusy=s3[1];
  var PC=['#00ff88','#4488ff','#ffcc00','#ff8844','#f7931a','#627eea','#ffd700','#00ccee','#aa66ff','#ff4466','#44cc44','#ff66aa','#cc44ff','#c0c0c0','#8b6914'];

  var run=function(){
    setBusy(true);
    setTimeout(function(){
      var sd=getStart(period);
      var ar={};
      ASSETS.forEach(function(t){var r=runStrategy(t,'dca',{budget:500,frequency:'monthly'},sd,null);if(r)ar[t]=r;});
      var av=Object.keys(ar);
      if(!av.length){setR(null);setBusy(false);return;}
      var byR=av.slice().sort(function(a,b){return ar[b].totalReturn-ar[a].totalReturn;});
      var byDD=av.slice().sort(function(a,b){return ar[b].maxDD-ar[a].maxDD;});
      var byS=av.slice().sort(function(a,b){var sa=ar[a].maxDD!==0?ar[a].cagr/Math.abs(ar[a].maxDD):0;var sb=ar[b].maxDD!==0?ar[b].cagr/Math.abs(ar[b].maxDD):0;return sb-sa;});

      var build=function(ranked,name,desc){
        var top=ranked.slice(0,5);
        var ws=[35,25,20,12,8];
        var allocs=top.map(function(t,i){var o=Object.assign({},ar[t]);o.w=ws[i];o.color=PC[ASSETS.indexOf(t)];return o;});
        var wr=allocs.reduce(function(s,a){return s+a.totalReturn*a.w/100;},0);
        var wc=allocs.reduce(function(s,a){return s+a.cagr*a.w/100;},0);
        return{name:name,desc:desc,allocs:allocs,wr:wr,wc:wc};
      };

      setR({
        maxR:build(byR,'üöÄ Maximum Returns','Optimized for highest total return'),
        bestS:build(byS,'‚öñÔ∏è Best Risk-Adjusted','Best return per unit of drawdown'),
        lowDD:build(byDD,'üõ°Ô∏è Lowest Drawdown','Minimizes portfolio drawdown'),
        ind:av.map(function(t){return ar[t];}).sort(function(a,b){return b.totalReturn-a.totalReturn;})
      });
      setBusy(false);
    },80);
  };

  useEffect(run,[period]);

  return React.createElement('div',null,
    React.createElement('div',{style:{textAlign:'center',padding:'28px 0 18px'}},
      React.createElement('h2',{style:{fontSize:26,fontWeight:800,marginBottom:6}},'Best Portfolios'),
      React.createElement('p',{style:{color:'var(--t2)',fontSize:13,marginBottom:16}},'Optimal allocations based on $500/mo DCA'),
      React.createElement('div',{className:'prow',style:{justifyContent:'center'}},[25,20,15,10,5,3].map(function(y){return React.createElement('div',{key:y,className:'pbtn'+(period===y?' on':''),onClick:function(){setP(y);}},y+'Y');}))
    ),
    busy?React.createElement('div',{className:'loading'},React.createElement('div',{className:'spinner'})):
    res&&React.createElement(React.Fragment,null,
      React.createElement('div',{className:'pfgrid'},
        [res.maxR,res.bestS,res.lowDD].map(function(p,pi){
          return React.createElement('div',{key:pi,className:'pfcard'},
            React.createElement('h3',null,p.name),
            React.createElement('div',{className:'dd'},p.desc),
            React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:18,fontWeight:700,color:'var(--g)',marginBottom:3}},fPct(p.wr)+' return'),
            React.createElement('div',{style:{fontFamily:'JetBrains Mono',fontSize:11,color:'var(--t2)',marginBottom:14}},'CAGR: '+fPct(p.wc)),
            React.createElement('div',{className:'abar'},p.allocs.map(function(a,i){return React.createElement('div',{key:i,style:{width:a.w+'%',background:a.color},title:a.label+': '+a.w+'%'});})),
            React.createElement('div',{className:'alist'},p.allocs.map(function(a,i){
              return React.createElement('div',{key:i,className:'aitm'},
                React.createElement('span',null,React.createElement('span',{className:'dot',style:{background:a.color}}),a.label),
                React.createElement('span',{style:{fontFamily:'JetBrains Mono',fontWeight:600}},a.w+'% ¬∑ '+fPct(a.totalReturn))
              );
            }))
          );
        })
      ),
      // Individual rankings
      React.createElement('div',{style:{marginTop:20,background:'var(--bg2)',border:'1px solid var(--bdr)',borderRadius:11,padding:16}},
        React.createElement('div',{style:{fontSize:13,fontWeight:600,marginBottom:10}},'Individual Rankings ('+period+'Y DCA)'),
        React.createElement('table',{className:'ct'},
          React.createElement('thead',null,React.createElement('tr',null,
            React.createElement('th',null,'#'),React.createElement('th',null,'Asset'),React.createElement('th',null,'Final Value'),React.createElement('th',null,'Invested'),React.createElement('th',null,'Return'),React.createElement('th',null,'CAGR'),React.createElement('th',null,'Max DD')
          )),
          React.createElement('tbody',null,
            res.ind.map(function(r,i){
              return React.createElement('tr',{key:r.ticker},
                React.createElement('td',{style:{color:i<3?'var(--y)':'var(--t4)'}},i+1),
                React.createElement('td',{style:{color:COLORS[r.ticker],fontWeight:600}},r.label),
                React.createElement('td',{style:{color:'var(--g)',fontWeight:600}},fmt(r.finalValue)),
                React.createElement('td',{style:{color:'var(--t2)'}},fmt(r.invested)),
                React.createElement('td',{style:{color:r.totalReturn>0?'var(--g)':'var(--r)'}},fPct(r.totalReturn)),
                React.createElement('td',null,fPct(r.cagr)),
                React.createElement('td',{style:{color:'var(--r)'}},fPct(r.maxDD))
              );
            })
          )
        )
      )
    )
  );
}

/* ===== APP ===== */
function App(){
  var s1=useState(0),tab=s1[0],setTab=s1[1];
  return React.createElement('div',null,
    React.createElement('div',{className:'hdr'},
      React.createElement('div',{className:'logo'},
        React.createElement('div',{className:'logo-i'},'SL'),
        React.createElement('div',null,
          React.createElement('div',{className:'logo-t'},'Strategy Lab'),
          React.createElement('div',{className:'logo-s'},'Multi-Asset Investment Simulator')
        )
      ),
      React.createElement('div',{className:'tabs'},
        ['üìä Simulator','‚è∞ Time Machine','üèÜ Portfolios'].map(function(t,i){
          return React.createElement('button',{key:i,className:'tab'+(tab===i?' on':''),onClick:function(){setTab(i);}},t);
        })
      )
    ),
    React.createElement('div',{className:'main'},
      tab===0&&React.createElement(Simulator,null),
      tab===1&&React.createElement(TimeMachine,null),
      tab===2&&React.createElement(BestPortfolios,null)
    )
  );
}

ReactDOM.render(React.createElement(App,null),document.getElementById('root'));
</script>
</body>
</html>
